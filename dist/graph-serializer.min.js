!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports"],e)}(function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){this.serializer=function(e){return e},this.deserializer=function(e){return e}};r.Scheme=i;var n=function(){function e(e,t){void 0===t&&(t={}),this.name=e,this.setDecoration(t)}return e.prototype.setDecoration=function(e){return this.scheme=void 0===e.scheme?new i:e.scheme,this.serializedName=void 0===e.serializedName?this.name:e.serializedName,this},e}();r.PropertyDescription=n;var t=function(){function e(){this.postDeserialize=function(){},this.properties=new Map}return e.prototype.setDecoration=function(e){return void 0===e||(this.postDeserialize=void 0===e.postDeserialize?function(){}:e.postDeserialize),this},e}();r.ClassDescription=t;var o,s=function(){function e(){this.map=new Map}return e.prototype.get=function(e){return this.map.has(e)||this.map.set(e,new t),this.map.get(e)},e.prototype.set=function(e,t){this.map.set(e,t)},e}(),c=new(r.Store=s);function a(e,r){if(null===r)return null;var i=new e;if(Object.getPrototypeOf(e)instanceof Function){var t=Object.getPrototypeOf(Object.getPrototypeOf(new e)).constructor;Object.assign(i,a(t,r))}return c.get(e).properties.forEach(function(e,t){void 0!==r[e.serializedName]&&(i[t]=e.scheme.deserializer(r[e.serializedName]))}),c.get(e).postDeserialize(i),i}function u(r){var i={};if(null===r)return null;if(Object.getPrototypeOf(r)===Object.prototype)return r;if(null!==Object.getPrototypeOf(Object.getPrototypeOf(r))&&Object.getPrototypeOf(Object.getPrototypeOf(r)).constructor!==Object){var e=new(Object.getPrototypeOf(Object.getPrototypeOf(r)).constructor);Object.assign(e,r),Object.assign(i,u(e))}return c.get(r.constructor).properties.forEach(function(e,t){i[e.serializedName]=e.scheme.serializer(r[t])}),i}r.deserialize=a,r.serialize=u,r.primitive=new i,r.date=((o=new i).serializer=function(e){return e instanceof Date?e.toJSON():e},o.deserializer=function(e){return"string"==typeof e?new Date(e):e},o),r.array=function(t){void 0===t&&(t=r.primitive);var e=new i;return e.serializer=function(e){return e.map(function(e){return t.serializer(e)})},e.deserializer=function(e){return void 0===e?e:e.map(function(e){return t.deserializer(e)})},e},r.object=function(t){var e=new i;return e.serializer=function(e){return u(e)},e.deserializer=function(e){return a(t,e)},e},r.custom=function(e,t){var r=new i;return r.serializer=e,r.deserializer=t,r},r.serializable=function(r){return void 0===r&&(r={}),function(e,t){if(1===arguments.length)c.get(e).setDecoration(r);else{if(3!==arguments.length)throw new Error("Invalid decorator");c.get(e.constructor).properties.set(t,new n(t,r))}}},r.postDeserialize=function(){return function(e,t,r){if(3!==arguments.length)throw new Error("Invalid decorator");var i=c.get(e);i.postDeserialize=r.value,c.set(e,i)}}});